# 锚点提取 vs 正则表达式

## 核心区别

| 特性 | 锚点提取 | 正则表达式 |
|------|---------|-----------|
| 配置难度 | 简单 | 中等 |
| 可靠性 | 中等 | 高 |
| 格式敏感度 | 高 | 低 |
| OCR 依赖 | 高 | 低 |
| 适用场景 | 表格、不固定格式 | 大多数场景 |

## 锚点提取的限制

### 文本格式敏感

```python
# OCR 可能识别为不同格式
"Messrs:    Forcome"  # 多个空格
"Messrs:\tForcome"    # 制表符
"Messrs:\nForcome"    # 换行符
```

### OCR 文本框顺序

视觉顺序和 OCR 顺序可能不一致，导致提取结果错误。

### 跨行文本

如果结束标记是 `\n`，只能提取第一行。

## 正则表达式的优势

### 格式无关

```regex
Messrs:\s*(.+?)(?:\s+Invoice|$)
```
- `\s*` 匹配任意空白字符
- 不受具体格式影响

### 精确控制

```regex
Amount:\s*\$?([\d,]+\.?\d*)
```
- 可选的 `$` 符号
- 千分位逗号
- 可选的小数

### 不依赖 OCR 结构

直接在合并文本中匹配，不受文本框顺序影响。

## 何时使用锚点提取

✅ **适合：**
- 表格数据（标签和值在不同单元格）
- 值的格式完全不固定
- 需要提取多行内容

❌ **不适合：**
- 标签和值在同一行
- 需要精确匹配
- OCR 文本框顺序混乱

## 何时使用正则表达式

✅ **适合：**
- 格式固定的数据（发票号、金额、日期）
- 需要精确匹配
- 多种可能的格式

## 实际案例

### 提取公司名称

**OCR 文本：**
```
Messrs: Forcome (Shanghai) Co.,Ltd Invoice No : FCM-250922
```

**锚点配置：**
```
锚点：Messrs:
方向：右侧
范围：150
结束标记：Invoice
```

**正则配置（推荐）：**
```regex
Messrs:\s*(.+?)(?:\s+Invoice|$)
```

### 提取金额

**OCR 文本：**
```
TOTAL $ 463.22
```

**锚点配置：**
```
锚点：TOTAL
方向：右侧
范围：20
```
问题：会提取到 `$ 463.22`

**正则配置（推荐）：**
```regex
TOTAL\s*\$?\s*([\d,]+\.?\d*)
```
结果：`463.22`

## 建议

1. **默认使用正则表达式**
2. **只在必要时使用锚点提取**
3. **结合"清洗校验"进一步处理数据**
