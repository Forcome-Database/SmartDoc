# 数据提取配置指南

## 配置步骤

### 1. 定义 Schema（数据结构）

在"Schema定义"标签页添加字段：

```json
{
  "invoice_no": {
    "type": "string",
    "description": "发票号码"
  },
  "amount": {
    "type": "number",
    "description": "金额"
  },
  "date": {
    "type": "string",
    "description": "日期"
  }
}
```

### 2. 配置提取策略

在"提取策略"标签页选择提取方式：

#### 正则表达式提取

适用于格式固定的数据：

```
提取方式：正则表达式
正则表达式：Invoice No:\s*([A-Z0-9-]+)
匹配模式：第一个匹配
捕获组：1
```

#### 锚点定位提取

适用于有明确标签的数据：

```
提取方式：锚点定位
锚点关键词：Total Amount:
搜索方向：向右
搜索距离：50 字符
提取模式：[\d,]+\.?\d*
```

#### 表格提取

适用于表格数据：

```
提取方式：表格提取
表格索引：0（第一个表格）
行索引：1
列索引：2
```

#### LLM 智能提取

适用于复杂场景：

```
提取方式：LLM智能提取
上下文范围：全文 / 前N页
提示词模板：请从文本中提取{field_name}的值
```

## 常用正则表达式

### 发票号
```regex
(?:Invoice|INV)[\s#:]*([A-Z0-9-]+)
```

### 金额
```regex
(?:Total|Amount|总额)[\s:：]*\$?([\d,]+\.?\d*)
```

### 日期
```regex
(\d{4}[-/]\d{2}[-/]\d{2})
```

### 邮箱
```regex
[\w.-]+@[\w.-]+\.\w+
```

### 电话
```regex
\+?\d{1,3}[-.\s]?\d{3,4}[-.\s]?\d{4}
```

## 调试技巧

1. **查看合并文本**：确认 OCR 识别结果
2. **测试正则**：使用 https://regex101.com/
3. **查看日志**：检查后端提取日志
4. **逐步调整**：从简单配置开始

## 提取方式选择

| 场景 | 推荐方式 |
|------|---------|
| 格式固定 | 正则表达式 |
| 有明确标签 | 锚点定位 |
| 表格数据 | 表格提取 |
| 复杂场景 | LLM智能提取 |
